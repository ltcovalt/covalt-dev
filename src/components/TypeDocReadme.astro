---
import {
	getTypedocReadmeMap,
	trimSlashes,
	rewriteRelativeLinks,
	stripFirstH1,
	loadCompiledHtmlFromGlob,
} from '@utils/typedoc.js';

const { apiPath } = Astro.props;
const rel = trimSlashes(apiPath);
const readmeMap = getTypedocReadmeMap();
const typedocPath = `/docs/${rel}/typedoc/README.md`;
const rawHtml = await loadCompiledHtmlFromGlob(readmeMap, typedocPath, 'TypeDoc README');
const baseUrl = `/docs/${rel}`;

let fixedHtml = rewriteRelativeLinks(rawHtml, baseUrl);
fixedHtml = stripFirstH1(fixedHtml);
---

<div set:html={fixedHtml} />
