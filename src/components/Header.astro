---
import { NavMenuDropdown } from '@components';
import { ThemeController } from '@components';

const headerLinks = [
	{ href: '/', label: 'home' },
	{ href: '/about', label: 'about' },
	{ href: '/docs', label: 'docs' },
	{ href: '/posts', label: 'posts' },
];

const activePageClass = 'underline decoration-accent decoration-2 underline-offset-8';
const currentPage = Astro.url.pathname.replace(/\/+$/, '') || '/';
const isCurrentPage = (href) => {
	const base = href.replace(/\/+$/, '') || '/';
	// exact match or prefix match for sub-pages
	return currentPage === base || (base !== '/' && currentPage.startsWith(base + '/'));
};
let { class: classes } = Astro.props;
---

<div class={`navbar flex min-h-14 gap-2 py-0 ${classes}`}>
	<!-- navbar is rendered as a dropdown menu for small screens -->
	<NavMenuDropdown>
		{
			headerLinks.map((link) => (
				<li>
					<a href={link.href} class={isCurrentPage(link.href) ? activePageClass : ''}>
						{link.label}
					</a>
				</li>
			))
		}
	</NavMenuDropdown>
	<div class="navbar-start">
		<a href="/" class="text-3xl opacity-40">covalt.dev</a>
	</div>

	<!-- center navbar, hidden for small screens -->
	<div class="navbar-center lg: hidden lg:flex lg:items-end">
		<ul class="menu menu-horizontal px-1 text-lg">
			{
				headerLinks.map((link) => (
					<li>
						<a
							href={link.href}
							class={
								isCurrentPage(link.href)
									? 'decoration-accent underline decoration-2 underline-offset-8'
									: ''
							}
						>
							{link.label}
						</a>
					</li>
				))
			}
		</ul>
	</div>
	<div class="navbar-end">
		<ThemeController />
	</div>
</div>
