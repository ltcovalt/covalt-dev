---
import { NavMenuDropdown } from "@components";
import { ThemeController } from "@components";

const headerLinks = [
	{ href: "/", label: "home" },
	{ href: "/about", label: "about" },
	{ href: "/blog", label: "blog" },
];

const activePageClass = "underline decoration-accent decoration-2 underline-offset-8";
const currentPage = Astro.url.pathname.replace(/\/+$/, "") || "/";
const isCurrentPage = (href) => {
	const base = href.replace(/\/+$/, "") || "/";
	// exact match or prefix match for sub-pages
	return currentPage === base || (base !== "/" && currentPage.startsWith(base + "/"));
};
---

<div class="navbar bg-base-100 shadow-sm flex items-center gap-2 min-h-14 py-0">
	<!-- navbar is rendered as a dropdown menu for small screens -->
	<NavMenuDropdown>
		{
			headerLinks.map((link) => (
				<li>
					<a href={link.href} class={isCurrentPage(link.href) ? activePageClass : ""}>
						{link.label}
					</a>
				</li>
			))
		}
	</NavMenuDropdown>
	<div class="navbar-start">
		<a href="/" class="text-3xl">covalt.dev</a>
	</div>

	<!-- center navbar, hidden for small screens -->
	<div class="navbar-center hidden md:flex">
		<ul class="menu menu-horizontal px-1 text-lg">
			{
				headerLinks.map((link) => (
					<li>
						<a
							href={link.href}
							class={isCurrentPage(link.href) ? "underline decoration-accent decoration-2 underline-offset-8" : ""}
						>
							{link.label}
						</a>
					</li>
				))
			}
		</ul>
	</div>
	<div class="navbar-end">
		<ThemeController />
	</div>
</div>
